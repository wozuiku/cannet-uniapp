<template>
	<view>
		<cu-custom bgColor="bg-gradual-blue" :isBack="true">

			<block slot="content">用电情况</block>
			<!-- <block slot="right">
			<view class="margin-right text-xxl">
					<navigator url="../sancode/sancode" open-type="navigate">
						<text class="cuIcon-add " style="font-size: 40upx;"></text>
					</navigator>
			</view>
			</block> -->
		</cu-custom>
		<scroll-view scroll-y="true" class="page">
			<view class="cu-list">
				<view class="cu-item bg-gradual-blue flexrowbetween">
					<view style="padding: 25rpx;padding-bottom: 50rpx;">
						<text style="font-size: 33rpx;color:#FFF;font-weight: bold;">A栋：2342342</text>
						<view>
							<text
								style="font-size: 26rpx;margin-top: 10rpx; color:#B2E0FE ;font-weight: 400;">用户号：2398472895743</text>
						</view>
					</view>
					<text class="cuIcon-right margin-right"></text>
				</view>
				<scroll-view scroll-x class=" bg-white nav solid-bottom" style="margin-top: 2rpx;">
					<view class="flex text-center">
						<view class="cu-item flex-sub" v-for="(item,index) in tablist" :key="index" @tap="tabSelect"
							:data-id="index">
							<text :class="index==TabCur?'text-blue cur cu-item':''">{{item.title}}</text>
						</view>

					</view>
				</scroll-view>
				
				<view v-show="TabCur==1">
					<!-- 时间 -->
					<scroll-view scroll-x scroll-with-animation class="bg-white nav text-center">
						<view class="cu-item" :class="index==TabCur?'text-blue ycur':''"
							v-for="(item,index) in yearlist" :key="index" @tap="tabSelect" :data-id="index">
							{{item}}
						</view>
					</scroll-view>
					
					<!-- 表号 -->
					<view class="cu-item padding-sm bg-white solid-bottom text-black text-bold">
						表号：98070340758
					</view>
					
					<view class="cu-item bg-white">
						<echarts :option="option" style="height: 300px;"></echarts>
					</view>
					<view class="cu-item bg-white">
						<table class="bg-white" width="100%" style="padding-right: 10rpx;">
							<tr style="width: 100%;padding: 6rpx 0rpx;margin-top: 16rpx; background-color: #eee;">
								<td class="td-typeheader" width="15%">月份</td>
								<td class="td-typeheader" width="25%" style="text-align: right;padding-right: 16rpx;">
									电能量值<br>(kWh)</td>
								<td class="td-typeheader" width="20%">电费<br>(元)</td>
								<td class="td-typeheader" width="20%">服务费<br>(元)</td>
								<td class="td-typeheader" width="20%" style="text-align: right;padding-right: 16rpx;">
									总费用<br>(元)</td>
							</tr>
							<tr style="width: 100%;padding: 6rpx 0rpx;" v-for="(item,index) in yflist">
								<td class="td-content" width="15%">{{item.name}}</td>
								<td class="td-content" width="25%" style="text-align: right;padding-right: 16rpx;">
									{{item.price}}
								</td>
								<td class="td-content" width="20%">{{item.price}}</td>
								<td class="td-content" width="20%">{{item.price}}</td>

								<td class="td-content" width="20%" style="text-align: right;padding-right: 16rpx;">
									{{item.price}}
								</td>
							</tr>
							<tr style="width: 100%;height: 88rpx;">
								<td class="td-total" width="15%">总计</td>
								<td class="td-total" width="25%" style="text-align: right;padding-right: 16rpx;">
									2342</td>
								<td class="td-total" width="20%">3245</td>
								<td class="td-total" width="20%">345</td>

								<td class="td-total" width="20%" style="text-align: right;padding-right: 16rpx;">
									3245</td>
							</tr>

						</table>
					</view>

				</view>
				
				<view v-show="TabCur==0">
					<view class="cu-item text-center bg-white padding-sm flexrow">
						<view class="text-center day-time-border flex" style="">
							<view class="day-time text-center " :class="daytime==0?'day-curr':''" @tap="changeDayTime(0)">近7天</view>
							<view class="day-time text-center" :class="daytime==1?'day-curr':''" @tap="changeDayTime(1)">近30天</view>
						</view>
					</view>
					<!-- 表号 -->
					<view class="cu-item padding-sm bg-white solid-bottom text-black text-bold margin-top-sm">
						表号：98070340758
					</view>
					
					<view class="cu-item bg-white">
						<echarts :option="optionline" style="height: 300px;"></echarts>
					</view>
					<view class="cu-item  padding-sm solid-bottom flex">
						<view class="flex-sub">
							时间
						</view>
						<view class="flex-sub">
							用电量(kWh)
						</view>
					</view>
					<view class="cu-item bg-white padding-sm solid-bottom  arrow " v-for="(item,index) in daytimelist" @tap="toOpenList(index,item)">
						<view class="flexrowstart" style="width: 100%;height: 66rpx;">
							<view class="flex-sub">
								2022-01-0{{index}}
							</view>
							<view class="flex-sub flex">
								<view class="flex-sub">{{index}}</view>
								<text :class="listcurr==index?'cuIcon-unfold':'cuIcon-right'"  style="float: right;"></text>
							</view>
						</view>
						<view v-show="listcurr==index" style=" height: 300rpx;">
							<view  style="width: 100%;" >
								<echarts :option="item.option" :ref="item.id" style="height: 300rpx;"></echarts>
							</view>
							
						</view>
					
					</view>
					
				</view>
			
			
				<view class="cu-form-group flexrowbetween"
					style="margin-top: 16rpx;padding: 0px;margin-bottom: 16rpx;">
					<view class="flexrowstart"
						style="flex-grow: 1;padding: 33rpx 27rpx;background: linear-gradient(-45deg, #D0E9FF 0%, #F7FBFF 100%);">
						<view class="bottom-image"
							style="background: url(../../static/icons/bill_function.png) no-repeat;background-size: 100%;">
						</view>
						<view class="flexcolumn" style="align-items: flex-start;margin-left: 8rpx;">
							<view class="bottom-useelect" style="">
								用电情况
							</view>
							<view class="bottom-useelect-tod">
								点击查看详情 >
							</view>
						</view>
					</view>
					<view class="flexrowstart"
						style="flex-grow: 1;padding: 33rpx 27rpx;background: linear-gradient(-45deg, #FFEBDD 0%, #FFFCF6 100%);">
						<view class="bottom-image"
							style="background: url(../../static/icons/bill_recharge.png) no-repeat;background-size: 100%;">
						</view>
						<view class="flexcolumn" style="align-items: flex-start;margin-left: 8rpx;">
							<view class="bottom-useelect" style="">
								充值
							</view>
							<view class="bottom-useelect-tod">
								立即去缴纳电费 >
							</view>
						</view>
					</view>
				</view>
			</view>

		</scroll-view>
	</view>
</template>
<script>
	import echarts from '@/components/echarts/echarts.vue';
	// import mecharts from '@/common/echarts/echarts-5.1.2-min.js'
	//import echarts from 'https://cdn.bootcdn.net/ajax/libs/echarts/4.9.0-rc.1/echarts.min.js'
	export default {
		data() {
			return {
				TabCur: 0,
				tablist: [{
					"title": "月度电费"
				}, {
					"title": "日用电量"
				}],
				yearlist: [2022, 2021, 2020],
				chartsDataColumn2: {},
				option: {},
				yflist: [],
				
				// 日用电量
				daytime:0,
				optionline:{},
				daytimelist:[],
				listcurr:0,
				dayoption:{},
				dayoptionids:{}
			}
		},
		onLoad() { //页面加载

		},
		onShow() { //页面显示
			this.option = {
				tooltip: {
					trigger: 'axis',
					axisPointer: {
						type: 'shadow'
					}
				},
				legend: {},
				grid: {
					left: '3%',
					right: '4%',
					bottom: '3%',
					containLabel: true
				},
				"dataZoom": [{
					"type": "inside",

				}, {
					"type": "inside",

				}, ],
				xAxis: [{
					type: 'category',
					data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
				}],
				yAxis: [{
					type: 'value'
				}],
				series: [

					{
						name: '一档',
						type: 'bar',
						stack: 'Ad',
						emphasis: {
							focus: 'series'
						},

						data: [120, 132, 101, 134, 90, 230, 210]
					},
					{
						name: '二档',
						type: 'bar',
						stack: 'Ad',
						emphasis: {
							focus: 'series'
						},
						data: [220, 182, 191, 234, 290, 330, 310]
					},
					{
						name: '三档',
						type: 'bar',
						stack: 'Ad',
						emphasis: {
							focus: 'series'
						},
						data: [150, 232, 201, 154, 190, 330, 410]
					},

				]
			};
			for (var i = 0; i < 5; i++) {
				this.yflist.push({
					"name": i + 1 + "月",
					"price": i + ""
				})
			}
			
			this.optionline={
				tooltip: {
					trigger: 'axis',
					axisPointer: {
						type: 'shadow'
					}
				},
				
				grid: {
					top:10,
					left: '3%',
					right: '4%',
					bottom: '3%',
					containLabel: true
				},
				"dataZoom": [{
					"type": "inside",
				
				}, {
					"type": "inside",
				
				}, ],
				xAxis: [{
					type: 'category',
					data: ['1', '2', '3', '4', '5', '6', '7'],
					axisLine: {
						show: true,
						color: "#999",
						symbol: ['none', 'arrow'],
						symbolOffset: [10, 10],
						symbolSize: [5, 8],
						lineStyle: {
							"color": "#999",//坐标轴X的颜色
						}
					}
				}],
				yAxis: [{
					type: 'value',
					 "name": "用电kWh",
					axisLine: {
						color: "#999",
						show: true,
						symbol: ['none', 'arrow'],
						symbolOffset: [10, 10],
						symbolSize: [5, 8],
						lineStyle: {
							"color": "#999",//坐标轴X的颜色
						}
					},
				}],
				series: [
				
					{
						name: '三档',
						type: 'line',
						emphasis: {
							focus: 'series'
						},
						
						data: [150, 232, 201, 154, 190, 330, 410]
					},
				
				]
			}
			var pie={
				  tooltip: {
				    trigger: 'item'
				  },
				  legend: {
				    orient: 'vertical',
				    left: 'left',
				     top: 'center'
				  },
				  "grid": {
						top: 10,
						left: '50%',
						right: '5%',
						bottom: 10,
						containLabel: true
					},
				  series: [
				    {
				      name: 'Access From',
				      type: 'pie',
				      radius: '50%',
				      data: [
				        { value: 0, name: 'Search Engine' },
				        { value: 735, name: 'Direct' },
				        { value: 580, name: 'Email' },
				        { value: 484, name: 'Union Ads' },
				        { value: 300, name: 'Video Ads' }
				      ],
				      emphasis: {
				        itemStyle: {
				          shadowBlur: 10,
				          shadowOffsetX: 0,
				          shadowColor: 'rgba(0, 0, 0, 0.5)'
				        }
				      },
				       label: {
				        show: false,
				      },
				       labelLine: {
				        show: false
				      },
				    }
				  ]
			}

			for (var i = 0; i < 7; i++) {
				let oprion=pie;
				let data=[
					 { value: 1048*i, name: '尖：' },
					        { value: 735*i, name: '峰：' },
					        { value: 580*i, name: '平：' },
					        { value: 484*i, name: '谷：' }
				]
				
				oprion.series[0].data=data;
				let item={"id":"id"+i,"option":oprion}
				this.daytimelist.push(item);
			}
			
		},
		onReady() { //页面初次显示
		},
		onHide() { //页面隐藏
		},
		onUnload() { //页面卸载

		},
		onBackPress() { //页面返回

		},
		onShareAppMessage() { //分享
		},
		onReachBottom() { //下拉加载
		},
		onPageScroll() { //页面滚动
			console.log('页面滚动...')
		},
		onPullDownRefresh() { //上拉刷新
			uni.stopPullDownRefresh();
		},

		// #ifdef APP-PLUS
		onNavigationBarButtonTap() {

		},
		// #endif
		methods: {
			tabSelect(e) {
				this.TabCur = e.currentTarget.dataset.id;
			},
			getIndex(e) {
				console.log("获取点击索引事件", e);
			},
			
			changeDayTime(tab){
				this.daytime=tab
			},
			toOpenList(index,item){
				this.listcurr=index;
				//echarts.resize()
				let id=item.id;
				console.log(this.$refs[id][0]);
				this.$refs[id][0].resizeChart()
			}
			
		}
	}
</script>

<style>
	.ycur {
		background: #007DFE;
		border-radius: 23px;
		border-bottom: 0px;
		height: 48rpx;
		line-height: 48rpx;
		color: #FFF;
	}

	table {
		border-spacing: 0px;
	}
table tr {
		width: 100%;
	}
	table tr td {
		text-align: center;
		border-top: 1px solid #f1f1f1;
		;
		border-bottom: 1px solid #f1f1f1;
		;
	}
	

	.td-typeheader {
		text-align: center;
	}

	.td-content {
		font-size: 26rpx;
		font-family: PingFang SC;
		font-weight: 400;
		color: #999999;
		line-height: 78rpx;
	}

	.td-total {
		font-size: 26rpx;
		font-family: PingFang SC;
		font-weight: 400;
		color: #333;
		line-height: 78rpx;
	}

	.charts-box {
		width: 100%;
		height: 300px;
		background-color: #fff;
	}
	
	/* 日用电量 */
	.day-time-border{
		border: 2rpx solid #e3e3e3;
		border-radius: 30rpx;
		width: 240rpx;
		height: 50rpx; 
		line-height: 50rpx;
	}
	.day-time{
		width: 120rpx;
		/* padding: 6rpx 15rpx; */
		height: 50rpx;
		line-height: 50rpx;
	}
	.day-curr{
		border-radius: 30rpx; 
		background-color: #007CFF;
		color: #fff;
	}
</style>
<style lang="scss" scoped>

</style>
